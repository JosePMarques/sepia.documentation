QSM Algorithms
==============

How can we map the magnetic susceptibility sources from local field map?
------------------------------------------------------------------------

A local field (or tissue field) is the field generated by the magnetic susceptibility sources from the brain tissue. The assumption of the field generated by a magnetic susceptibility point source is a dipole field. We can then try to compute the susceptibility values by deconvolving the local field with a dipole field. However, due to the fact that the dipole field in the k-space (i.e. the dipole kernel) has zero values on the cone surface at 54.7Â° and values close to this surface will also be close to zeros. As a result, the number of unknown parameters is more than the measurements we have in the data, leading to the problem ill-conditioned and the resulting QSM map has the so-called streaking artefact. To solve the ill-conditioned problem, most of the QSM algorithms try to add a regularisation term in the QMS dipole inversion problem, imposing spatial smoothness in the QSM map and/or the QSM map has similar anatomical features as shown in the magnitude images in order to reduce the streaking artefact in the QSM result.

Supported algorithms in SEPIA
-----------------------------

1. `TKD <https://doi.org/10.1002/mrm.22334>`_  

    Thresholded k-space division

2. `Closed-form solution <https://doi.org/10.1002/jmri.24365>`_  

    closed-form solution with L2-norm regularisation

3. NDI

4. `STI suite iLSQR <https://doi.org/10.1016/j.neuroimage.2010.11.088>`_  

    STI suite v3.0 implementation of iterative LSQR approach

5. `iLSQR <https://doi.org/10.1016/j.neuroimage.2010.11.088>`_


6. `FANSI <https://doi.org/10.1002/mrm.27073>`_  

    Fast algorithm for nonlinear susceptibility inversion

7. `Star <https://doi.org/10.1002/nbm.3383>`_ 

    STI suite v3.0 Star-QSM (recommended)

8. `MEDI <https://doi.org/10.1002/mrm.26946>`_  

    Morphology enabled dipole inversion (MEDI+0)   
