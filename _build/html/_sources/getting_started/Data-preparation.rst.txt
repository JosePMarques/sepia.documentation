Data Preparation
================

**SEPIA** supports the following type of data input:  

- uncompressed or compressed NIfTI images (.nii and .nii.gz)  

DICOM images
------------

DICOM images input has been deprecated since v.0.7.0.

NIfTI images
------------

NIfTI data is a handy way to work with **SEPIA**. **SEPIA** is mainly designed for multi-echo GRE (mGRE) data. Therefore, the main standalone of **SEPIA** can only work with 4D (row, column, slice, time) NIfTI data (3D for some standalone applications).  

Data conversion
^^^^^^^^^^^^^^^

So far there are three data conversion tools tested in SEPIA:

1. One way to convert DICOM images into 4D NIfTI data is to use `MRIConvert <https://lcni.uoregon.edu/downloads/mriconvert>`_ with the following setting checked: 'Option' -> 'Save multivolumes series as 4D files'  

.. image:: images/mriconvert_save4d.png  

In this way, your mGRE data will be stored as 4D FSL NIfTI data that is a valid input of **SEPIA**.  

2. Alternatively, you can also use `dcm2niix <https://github.com/neurolabusc/dcm2niix>`_ to convert your data. Please make sure the 'merge' option (-m) is set to 'no' for the conversion (i.e. ``dcm2niix -m n``). In this way, multiple 3D volumes (the number of volumes depends on the number of echoes acquired) will be created together with the JSON files containing the TE of each echo (if you enable the merge option of dcm2niix you will only have one JSON file containing one TE). You can then merge the echo images into 4D using tools like `fslmerge <https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Fslutils>`_.  

3. File formats generated by `dicm2nii <https://github.com/xiangruili/dicm2nii>`_ are also supported in SEPIA.

Data input
^^^^^^^^^^

Once you have the NIfTI files ready, **SEPIA** provides two options to load the data: 

- select the required files directly, or  
- prepare the data with specific names and put all of them in a common directory, from which you can specify the input directory in **SEPIA**. The name requirement depends on the standalone you are working on. For more specific details please check the wiki pages of each standalone applications. 